<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio - Muhammad Umar</title>
    <!-- Load Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font --><style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        
        :root {
            --color-glass: rgba(43, 49, 63, 0.4); /* Dark transparency */
            --color-border: rgba(255, 255, 255, 0.1);
            --color-accent: #34d399; /* Emerald */
            --color-bg: #0f172a; /* Slate-900 */
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-bg);
            background-image: radial-gradient(circle at 50% 10%, #1e3a8a 0%, transparent 40%); /* Subtle blue glow */
            color: #e2e8f0; 
            transition: all 0.3s ease-in-out;
            scroll-behavior: smooth;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
        
        /* Glassmorphism Effect */
        .glass-panel {
            background: var(--color-glass);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--color-border);
            border-radius: 1.5rem;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
            /* This is crucial for the aspect ratio children */
            overflow: hidden;
        }

        /* Portfolio Item Style */
        .project-card {
            transition: transform 0.3s, box-shadow 0.3s, border-color 0.3s;
        }

        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(52, 211, 153, 0.2); /* Emerald glow */
            border-color: var(--color-accent);
        }

        /* --- Scroll Animation Classes --- */
        .fade-in {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .fade-in.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Delay for grid items */
        .project-card.fade-in {
            transition-delay: var(--delay); /* Custom property for staggered delay */
        }
        
        /* Security Deterrents */
        .prevent-download {
            pointer-events: none;
            user-select: none;
            -webkit-user-drag: none;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--color-bg); }
        ::-webkit-scrollbar-thumb { 
            background: var(--color-accent); 
            border-radius: 4px; 
            border: 2px solid var(--color-bg);
        }

        /* --- CUSTOM ASPECT RATIO FOR 4:5 --- */
        .aspect-4x5 {
            /* (5 / 4) * 100 = 125% padding-top */
            padding-top: 125%; 
        }

        /* Typewriter effect for hero text */
        .typewriter-text-container {
            display: inline-block;
            overflow: hidden; 
            white-space: nowrap; /* Forces text onto a single line */
            border-right: 0.15em solid var(--color-accent); /* Blinking cursor */
            animation: 
                typing 1.8s steps(30, end),
                blink-caret 0.75s step-end infinite;
            text-align: left;
        }

        .typewriter-text {
            display: inline;
        }

        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }

        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: var(--color-accent); }
        }
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-left-color: #34d399; /* Emerald */
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* --- Custom Video Player Styles --- */
        .custom-player {
            position: relative;
            width: 100%;
            max-height: 80vh; 
            overflow: hidden;
            border-radius: 0.5rem; 
        }
        .custom-player video {
            width: 100%;
            height: 100%;
            display: block;
        }
        .video-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            opacity: 0;
            transition: opacity 0.3s ease-out;
        }
        .custom-player:hover .video-controls {
            opacity: 1;
        }
        .video-controls button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 0.25rem;
        }
        .video-controls button:hover {
            color: var(--color-accent);
        }
        .seek-bar-container {
            flex-grow: 1;
            cursor: pointer;
            height: 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 5px;
            position: relative;
        }
        .seek-bar-progress {
            height: 100%;
            width: 0%;
            background: var(--color-accent);
            border-radius: 5px;
            pointer-events: none;
        }
        .volume-controls {
            display: flex;
            align-items: center;
        }
        .volume-slider {
            width: 70px;
            margin-left: 5px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(255,255,255,0.2);
            height: 5px;
            border-radius: 5px;
            outline: none;
        }
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            background: var(--color-accent);
            border-radius: 50%;
            cursor: pointer;
        }
        .volume-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: var(--color-accent);
            border-radius: 50%;
            cursor: pointer;
        }
        .video-time {
            color: white;
            font-size: 0.75rem;
            margin-left: 10px;
        }

        /* --- NEW: Image Slider (Carousel) Styles --- */
        .slider-container {
            position: relative;
            width: 100%;
            overflow: hidden;
            border-radius: 0.5rem; /* Match modal content radius */
        }
        .slider-slide {
            display: none; /* Hidden by default */
            width: 100%;
            height: 100%;
            animation: fadeIn 0.5s ease-in-out; /* Simple fade effect */
        }
        .slider-slide.active {
            display: block; /* Show the active slide */
        }
        .slider-slide img {
            width: 100%;
            height: 100%;
            object-fit: contain; /* 'contain' is best for portfolio images */
            border-radius: 0.5rem; /* Match parent */
            max-height: 75vh; /* Ensure it fits in the modal */
        }
        .slider-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.4);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 24px;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        .slider-btn:hover {
            background: var(--color-accent);
            color: var(--color-bg);
        }
        .slider-btn-prev {
            left: 10px;
        }
        .slider-btn-next {
            right: 10px;
        }
        @keyframes fadeIn {
            from { opacity: 0.4; }
            to { opacity: 1; }
        }

    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-accent': '#34d399', /* Emerald-400 */
                        'dark-bg': '#0f172a', /* Slate-900 */
                        'dark-panel': '#1e293b', /* Slate-800 */
                    }
                }
            }
        }
    </script>
</head>
<body class="min-h-screen">
    <!-- Disable right-click globally on the body --><script>
        document.addEventListener('contextmenu', event => event.preventDefault());
    </script>

    <!-- Header & Navigation --><header class="sticky top-0 z-50 bg-dark-bg/80 backdrop-blur-md shadow-lg py-3 border-b border-white/10">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <a href="#" class="text-2xl font-extrabold text-primary-accent tracking-wider">
                Muhammad Umar <span class="text-white/70 font-light text-base block sm:inline-block">Creative Technologist</span>
            </a>
            <nav class="space-x-4 hidden md:block">
                <a href="#portfolio" class="text-white/80 hover:text-primary-accent transition duration-200">Showcase</a>
                <a href="#technical-stack" class="text-white/80 hover:text-primary-accent transition duration-200">Tech Stack</a>
                <a href="#about" class="text-white/80 hover:text-primary-accent transition duration-200">About</a>
                <!-- UPDATED: This now links to the #contact section at the bottom -->
                <a href="#contact" class="px-4 py-1 bg-primary-accent text-dark-bg rounded-full hover:bg-emerald-300 transition duration-200 font-semibold shadow-md">Contact</a>
            </nav>
        </div>
    </header>

    <main>
        <!-- Hero Section --><section id="hero" class="py-24 sm:py-32 text-center fade-in">
            <div class="glass-panel max-w-5xl mx-auto p-8 sm:p-12">
                <h1 class="text-5xl sm:text-7xl font-extrabold mb-4 leading-tight tracking-tight">
                    <div class="typewriter-text-container mx-auto">
                        <span class="typewriter-text">
                            <span class="text-white/90">Visualizing</span> <span class="text-primary-accent">Innovation.</span>
                        </span>
                    </div>
                </h1>
                <p class="text-xl text-white/70 max-w-4xl mx-auto font-light fade-in" style="transition-delay: 1s;">
                    A multi-disciplinary specialist creating **photorealistic 3D art** and automating workflows with **Python, Web, and E-commerce** solutions.
                </p>
            </div>
        </section>

        <!-- Portfolio Grid Section (Showcase) --><section id="portfolio" class="py-16 sm:py-24">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl sm:text-4xl font-bold text-center mb-12 text-white/90 fade-in">Featured Renders & Creative Projects</h2>
                <div id="portfolio-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Projects are injected here --></div>
            </div>
        </section>

        <!-- Technical Stack Section (Code & Web Skills) --><section id="technical-stack" class="py-16 bg-dark-bg/50">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl sm:text-4xl font-bold text-center mb-12 text-primary-accent fade-in">My Technical Stack & Platforms</h2>
                
                <div class="glass-panel p-8 max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 text-center fade-in" style="transition-delay: 0.2s;">
                    
                    <!-- Column 1: 3D Art Tools --><div class="fade-in" style="transition-delay: 0.3s;">
                        <svg class="w-10 h-10 mx-auto mb-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 11.056l7.5-3.75V15.75l-7.5 3.75-7.5-3.75V7.306l7.5-3.75zM12 11.056v8.444M19.5 7.306L12 11.056m-7.5-3.75l7.5 3.75"></path></svg>
                        <p class="font-bold text-lg mb-2 text-primary-accent">3D & Creative Art</p>
                        <p id="skill-3d" class="text-white/70">Blender (Cycles/Evee), Marvelous Designer, Photoshop, Unreal Engine.</p>
                    </div>

                    <!-- Column 2: Code & Automation --><div class="fade-in" style="transition-delay: 0.4s;">
                        <svg class="w-10 h-10 mx-auto mb-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg>
                        <p class="font-bold text-lg mb-2 text-primary-accent">Code & Automation</p>
                        <p id="skill-code" class="text-white/70">Python (Scripting/Tools), HTML/CSS, JavaScript, PHP (Backend Logic).</p>
                    </div>

                    <!-- Column 3: Web & E-commerce --><div class="fade-in" style="transition-delay: 0.5s;">
                        <svg class="w-10 h-10 mx-auto mb-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg>
                        <p class="font-bold text-lg mb-2 text-primary-accent">E-commerce & Web Platforms</p>
                        <p id="skill-web" class="text-white/70">Shopify, Webflow, WordPress, Figma (Design).</p>
                    </div>
                </div>

                <div class="flex justify-center mt-12 fade-in" style="transition-delay: 0.6s;">
                    <button id="analyze-button" onclick="analyzeTechStack()" class="px-6 py-3 bg-white/10 text-white rounded-lg font-bold hover:bg-white/20 transition duration-300 flex items-center shadow-lg">
                        <span id="analysis-text">Analyze Tech Stack Synergies ✨</span>
                    </button>
                </div>
                
                <!-- Gemini LLM Output Area for Tech Stack Analysis -->
                <div id="analysis-output" class="glass-panel p-6 mt-8 max-w-4xl mx-auto hidden">
                    <p class="font-bold text-lg mb-3 text-primary-accent">Creative Technologist Synergy Analysis</p>
                    <div id="analysis-content" class="text-sm text-white/70 italic">
                        The analysis of your diverse skills will appear here.
                    </div>
                </div>

            </div>
        </section>

        <!-- About Section --><section id="about" class="py-16 sm:py-24">
            <div class="container mx-auto px-4 max-w-4xl">
                <h2 class="text-3xl sm:text-4xl font-bold text-center mb-12 text-white/90 fade-in">About Muhammad Umar</h2>
                <div class="glass-panel p-8 fade-in" style="transition-delay: 0.2s;">
                    <p class="text-white/70 leading-relaxed mb-4">
                        I am a **Creative Technologist** with a unique blend of high-end artistic skill and engineering capability. My passion lies in **photorealism and cinematic animation** using tools like Blender and Marvelous Designer, ensuring every asset meets professional production standards.
                    </p>
                    <p class="text-white/70 leading-relaxed">
                        Beyond art, I specialize in efficiency, building custom **Python tools** to streamline asset pipelines and developing responsive, high-performance **e-commerce websites** (Shopify, Webflow) that convert. I am actively seeking roles where both artistic vision and technical problem-solving are valued.
                    </p>
                </div>
            </div>
        </section>

        <!-- NEW: Contact Section -->
        <section id="contact" class="py-16 sm:py-24">
            <div class="container mx-auto px-4 max-w-4xl">
                <h2 class="text-3xl sm:text-4xl font-bold text-center mb-12 text-white/90 fade-in">Get In Touch</h2>
                <div class="glass-panel p-8 sm:p-12 text-center fade-in" style="transition-delay: 0.2s;">
                    <p class="text-xl text-white/70 max-w-xl mx-auto font-light mb-8">
                        I am currently available for freelance projects and full-time opportunities. Let's build something amazing together.
                    </p>
                    <div class="flex flex-col sm:flex-row justify-center gap-6">
                        <!-- Email Button -->
                        <a href="mailto:ranaasim9993@gmail.com" 
                           class="px-8 py-3 bg-primary-accent text-dark-bg text-lg font-bold rounded-xl shadow-2xl shadow-primary-accent/40 hover:bg-emerald-300 transition duration-300 transform hover:scale-105 inline-block">
                            Email Me Directly
                        </a>
                        <!-- LinkedIn Button -->
                        <a href="https://www.linkedin.com/in/muhammad-umar-695730352" 
                           target="_blank" 
                           class="px-8 py-3 bg-white/10 text-white/90 text-lg font-bold rounded-xl backdrop-blur-sm border border-white/20 hover:bg-white/20 transition duration-300 transform hover:scale-105 inline-block">
                            Connect on LinkedIn
                        </a>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer --><footer class="bg-dark-panel/50 mt-12 py-6 border-t border-white/10">
        <div class="container mx-auto px-4 text-center text-sm text-white/50">
            &copy; <span id="current-year"></span> Muhammad Umar | Creative Technologist
        </div>
    </footer>

    <!-- Project Modal (Lightbox) -->
    <div id="project-modal" class="fixed inset-0 bg-dark-bg/95 z-50 hidden items-center justify-center p-4" onclick="closeModal(event)">
        <!-- MODAL CONTAINER: Increased max-width to 'max-w-6xl' for the two-column layout -->
        <div class="glass-panel rounded-xl max-w-6xl w-full max-h-full overflow-y-auto" onclick="event.stopPropagation()">
            <div class="p-6 md:p-8">
                <button class="float-right text-gray-400 hover:text-primary-accent text-3xl font-light" onclick="closeModal()">
                    &times;
                </button>
                <h3 id="modal-title" class="text-3xl font-bold mb-6 text-primary-accent">Project Title</h3>
                
                <!-- Project Content Area: Displays Image or Video Embed -->
                <div id="modal-content-area" class="w-full h-auto rounded-lg mb-6 border border-white/10 bg-dark-panel/50 overflow-hidden">
                    <!-- Dynamic content (img, iframe, or custom video player) will be inserted here -->
                </div>
                
                <!-- NEW: Two-Column Layout Container -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
                    
                    <!-- Left Column (Details & AI Button) -->
                    <div class="flex flex-col space-y-6">
                        <!-- Category & Software -->
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <p class="font-bold text-white/70">Category:</p>
                                <p id="modal-category" class="text-primary-accent">Environment Art</p>
                            </div>
                            <div>
                                <p class="font-bold text-white/70">Software/Stack:</p>
                                <p id="modal-software" class="text-primary-accent">Blender, Substance Painter</p>
                            </div>
                        </div>
                        
                        <!-- AI Description Drafter Button -->
                        <div class="flex-grow flex items-end">
                            <button id="draft-description-button" onclick="draftDescription()" class="w-full px-4 py-3 text-sm bg-white/10 text-white rounded-lg hover:bg-white/20 transition duration-300 flex items-center justify-center">
                                <span id="draft-text">Draft Description with AI ✨</span>
                            </button>
                        </div>
                    </div>

                    <!-- Right Column (Description & Breakdown) -->
                    <div class="space-y-6 md:border-l md:border-white/10 md:pl-8">
                        <!-- Description Area -->
                        <div>
                            <p class="font-bold text-lg text-white/90 mb-2">Project Description</p>
                            <p id="modal-description" class="text-white/70 leading-relaxed text-sm">
                                Detailed description of the project goes here.
                            </p>
                        </div>

                        <!-- Technical Breakdown Section -->
                        <div class="bg-dark-panel/70 p-4 rounded-lg border border-white/10">
                            <p class="font-bold text-white/90 mb-2 border-b border-white/10 pb-1 text-lg text-primary-accent">Technical Breakdown</p>
                            <p id="modal-technical" class="text-sm text-white/50 italic leading-relaxed">
                                Technical details about polycount, texture size, and optimization go here.
                            </p>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>


    <script>
        // --- Gemini API Configuration ---
        const API_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=";
        const apiKey = ""; // Leave as empty string. Canvas provides the key.

        // --- Utility for Exponential Backoff (API calls) ---
        async function fetchWithBackoff(url, options, maxRetries = 5) {
            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(url, options);
                    if (response.status === 429 || response.status >= 500) {
                        throw new Error(`Server error: ${response.status}`);
                    }
                    return response;
                } catch (error) {
                    if (i === maxRetries - 1) throw error;
                    const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }
        }

        // --- Gemini Feature 1: Draft Project Description ---
        async function draftDescription() {
            const draftButton = document.getElementById('draft-description-button');
            const draftTextSpan = document.getElementById('draft-text');
            const descriptionElement = document.getElementById('modal-description');
            const technicalElement = document.getElementById('modal-technical');
            const titleElement = document.getElementById('modal-title');
            const categoryElement = document.getElementById('modal-category');
            const softwareElement = document.getElementById('modal-software');

            // Collect current project details
            const projectTitle = titleElement.textContent;
            const projectCategory = categoryElement.textContent;
            const projectSoftware = softwareElement.textContent;
            const projectTechDetails = technicalElement.textContent;

            const userPrompt = `Draft a compelling, professional, and concise project description (max 4 sentences) for a portfolio piece. Focus on the creative intent and technical execution.
            
            - Title: ${projectTitle}
            - Category: ${projectCategory}
            - Software/Stack: ${projectSoftware}
            - Technical Breakdown: ${projectTechDetails}`;

            // Set loading state
            draftButton.disabled = true;
            draftButton.classList.remove('justify-end');
            draftButton.innerHTML = '<div class="spinner"></div>Generating...';

            try {
                const payload = {
                    contents: [{ parts: [{ text: userPrompt }] }],
                    systemInstruction: {
                        parts: [{ text: "You are a professional marketing copywriter for a high-end 3D artist and Creative Technologist. Your tone should be polished, technical, and impressive." }]
                    },
                    generationConfig: { // Use generationConfig
                         maxOutputTokens: 200,
                         temperature: 0.7
                    }
                };

                const response = await fetchWithBackoff(API_URL + apiKey, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                const generatedText = result.candidates?.[0]?.content?.parts?.[0]?.text;

                if (generatedText) {
                    descriptionElement.textContent = generatedText.trim();
                } else {
                    console.error("Gemini API Error: No text generated.", result);
                    descriptionElement.textContent = "Error generating description. Please try again.";
                }

            } catch (error) {
                console.error("Gemini API Error:", error);
                descriptionElement.textContent = "Failed to connect to AI service. Check console for details.";
            } finally {
                // Restore button state
                draftButton.disabled = false;
                draftButton.innerHTML = '<span id="draft-text">Draft Description with AI ✨</span>';
            }
        }

        // --- Gemini Feature 2: Analyze Tech Stack Synergies ---
        async function analyzeTechStack() {
            const analyzeButton = document.getElementById('analyze-button');
            const outputArea = document.getElementById('analysis-output');
            const outputContent = document.getElementById('analysis-content');
            
            const skills3D = document.getElementById('skill-3d').textContent;
            const skillsCode = document.getElementById('skill-code').textContent;
            const skillsWeb = document.getElementById('skill-web').textContent;

            const userPrompt = `Analyze the following three pillars of a Creative Technologist's skill set. In a single paragraph, describe the unique synergy and value this combination creates for a potential employer (e.g., how Python scripting helps 3D pipelines, or how web skills enhance presentation).
            
            1. 3D & Creative Art: ${skills3D}
            2. Code & Automation: ${skillsCode}
            3. Web & E-commerce: ${skillsWeb}`;
            
            // Set loading state
            analyzeButton.disabled = true;
            analyzeButton.innerHTML = '<div class="spinner"></div>Analyzing...';
            outputArea.classList.remove('hidden');
            outputContent.innerHTML = 'Analyzing skill synergy...';

            try {
                const payload = {
                    contents: [{ parts: [{ text: userPrompt }] }],
                    systemInstruction: {
                        parts: [{ text: "You are a senior technical recruiter specializing in interdisciplinary creative roles. Provide a sharp, concise analysis aimed at hiring managers." }]
                    },
                    generationConfig: { // Use generationConfig
                         maxOutputTokens: 250,
                         temperature: 0.5
                    }
                };

                const response = await fetchWithBackoff(API_URL + apiKey, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                const generatedText = result.candidates?.[0]?.content?.parts?.[0]?.text;

                if (generatedText) {
                    outputContent.textContent = generatedText.trim();
                } else {
                    console.error("Gemini API Error: No text generated.", result);
                    outputContent.textContent = "Error: Could not retrieve analysis.";
                }

            } catch (error) {
                console.error("Gemini API Error:", error);
                outputContent.textContent = "Failed to connect to AI service. Check console for details.";
            } finally {
                // Restore button state
                analyzeButton.disabled = false;
                analyzeButton.innerHTML = '<span id="analysis-text">Analyze Tech Stack Synergies ✨</span>';
            }
        }
        
        // --- Custom Video Player Functions ---

        // Toggles Play/Pause state
        function togglePlayPause(video, playPauseBtn) {
            if (video.paused) {
                video.play();
            } else {
                video.pause();
            }
        }

        // Updates the Play/Pause button icon
        function updatePlayPauseIcon(video, playIcon, pauseIcon) {
            if (video.paused) {
                playIcon.classList.remove('hidden');
                pauseIcon.classList.add('hidden');
            } else {
                playIcon.classList.add('hidden');
                pauseIcon.classList.remove('hidden');
            }
        }

        // Formats time from seconds to 00:00
        function formatTime(timeInSeconds) {
            const minutes = Math.floor(timeInSeconds / 60);
            const seconds = Math.floor(timeInSeconds % 60);
            return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        // Updates the seek bar and time display
        function updateVideoProgress(video, seekBar, currentTimeEl, durationTimeEl) {
            const progress = (video.currentTime / video.duration) * 100;
            // seekBar.value = progress; // This should be for a range input, but we use a div
            
            const progressFill = seekBar; // seekBar is now the progress div
            if (progressFill) {
                progressFill.style.width = `${progress}%`;
            }
            
            currentTimeEl.textContent = formatTime(video.currentTime);
            if (isFinite(video.duration)) {
                 durationTimeEl.textContent = formatTime(video.duration);
            }
        }

        // Allows seeking by clicking the seek bar
        function setVideoProgress(event, video, seekBarContainer) {
            const rect = seekBarContainer.getBoundingClientRect();
            const pos = (event.clientX - rect.left) / rect.width;
            video.currentTime = pos * video.duration;
        }

        // Toggles Mute/Unmute state
        function toggleMute(video, muteIcon, unmuteIcon) {
            video.muted = !video.muted;
            if (video.muted) {
                muteIcon.classList.remove('hidden');
                unmuteIcon.classList.add('hidden');
            } else {
                muteIcon.classList.add('hidden');
                unmuteIcon.classList.remove('hidden');
            }
        }

        // Sets the volume from the slider
        function setVolume(video, volumeSlider) {
            video.volume = volumeSlider.value;
            video.muted = volumeSlider.value === '0';
        }

        // Enters/Exits fullscreen mode
        // FIX: Removed this function as it's disallowed by permissions policy
        // function toggleFullscreen(playerContainer) { ... }

        // Initializes all event listeners for the custom player
        function initializeCustomPlayer(containerId) {
            const player = document.getElementById(containerId);
            if (!player) return;

            const video = player.querySelector('video');
            const playPauseBtn = player.querySelector('#playPauseBtn');
            const playIcon = player.querySelector('#playIcon');
            const pauseIcon = player.querySelector('#pauseIcon');
            const seekBarContainer = player.querySelector('.seek-bar-container');
            const seekBar = player.querySelector('.seek-bar-progress'); // This is the fill div
            const currentTimeEl = player.querySelector('#currentTime');
            const durationTimeEl = player.querySelector('#durationTime');
            const muteBtn = player.querySelector('#muteBtn');
            const muteIcon = player.querySelector('#muteIcon');
            const unmuteIcon = player.querySelector('#unmuteIcon');
            const volumeSlider = player.querySelector('#volumeSlider');
            // FIX: Removed fullscreenBtn reference
            // const fullscreenBtn = player.querySelector('#fullscreenBtn');

            // Play/Pause
            playPauseBtn.addEventListener('click', () => togglePlayPause(video, playPauseBtn));
            video.addEventListener('play', () => updatePlayPauseIcon(video, playIcon, pauseIcon));
            video.addEventListener('pause', () => updatePlayPauseIcon(video, playIcon, pauseIcon));
            
            // Time & Seek Bar
            video.addEventListener('loadedmetadata', () => updateVideoProgress(video, seekBar, currentTimeEl, durationTimeEl));
            video.addEventListener('timeupdate', () => updateVideoProgress(video, seekBar, currentTimeEl, durationTimeEl));
            seekBarContainer.addEventListener('click', (e) => setVideoProgress(e, video, seekBarContainer));
            
            // Volume
            muteBtn.addEventListener('click', () => toggleMute(video, muteIcon, unmuteIcon));
            volumeSlider.addEventListener('input', () => setVolume(video, volumeSlider));
            
            // FIX: Removed fullscreenBtn event listener
            // fullscreenBtn.addEventListener('click', () => toggleFullscreen(player));

            // Initial state update
            updatePlayPauseIcon(video, playIcon, pauseIcon);
            updateVideoProgress(video, seekBar, currentTimeEl, durationTimeEl);
        }

        // --- Core Data: Projects across all 3 disciplines ---
        const portfolioData = [
            // --- 3D Art Projects ---
            {
                title: 'Mobility Scooter Animation',
                category: '3D Animation',
                software: 'Blender, Capcut',
                description: 'A 3D concept model of a next-generation mobility scooter, blending futuristic automotive design with practical accessibility. This project focuses on hard-surface modeling techniques, realistic material definition (metallic paints, plastics, and leather), and studio lighting to create a clean, compelling product visual.',
                technicalDetails: 'High-poly model created in Blender, utilizing subdivision surfacing and Bevel/Boolean workflows. Textured using procedural nodes within Blender for the main body paint and leather. Rendered in Cycles with an HDRI studio setup complemented by key mesh lights to create sharp highlights and define the form.',
                image: 'https://github.com/umarwt06/umarwt06.github.io/blob/main/videoframe_5129.png?raw=true', 
                ratio: '4/5', // UNIFIED RATIO
                type: 'video',
                videoUrl: 'https://fiverr-res.cloudinary.com/video/upload/t_fiverr_hd/nnwf87camrum8mwcah5h' 
            },
            {
                title: 'JBL Headphones 3D Animation',
                category: '3D Model / Product Design / 3D Animation',
                software: 'Blender, Capcut',
                description: 'A high-fidelity 3D product render of JBL headphones, created to showcase a clean, modern aesthetic. This project emphasizes detailed hard-surface modeling, precise material definition for brushed metals and plastics, and dramatic studio lighting to capture the products sleek form and branding.',
                technicalDetails: 'Modeled in Blender using a non-destructive, subdivision-based workflow. Materials are a mix of procedural PBR shaders and image-based textures for fine details like the logo. Lit using a classic three-point lighting setup with an additional rim light to define the silhouette. Rendered in Cycles with high samples and denoising, with final color grading and bloom effects applied in Capcut.',
                image: 'https://i.postimg.cc/qhBN2kjX/download-1.png',
                ratio: '4/5', // UNIFIED RATIO
                type: 'video',
                videoUrl: 'https://fiverr-res.cloudinary.com/video/upload/t_fiverr_hd/q2oyuu3ghfaw1obbueah',
            },
            {
                title: 'Perfume Bottle 3d Model',
                category: '3D Model / Product Design',
                software: 'Blender, Photoshop',
                description: 'A photorealistic 3D product render focusing on high-end cinematic lighting and material fidelity. This project showcases a detailed study of light refraction and caustics through complex glass and liquid shaders, designed to create a dramatic, premium, and sophisticated product image suitable for advertising and marketing campaigns.',
                technicalDetails: 'Modeled, textured, and lit in Blender, rendered in Cycles. Utilized a multi-layered shader graph for the glass, capturing realistic internal reflections and liquid viscosity. The scene is lit by mesh-based studio lights to create soft highlights and deep, atmospheric shadows. Post-processing in Photoshop for final color grading.',
                image: 'https://github.com/umarwt06/umarwt06.github.io/blob/main/perfume.png?raw=true', 
                ratio: '4/5', // UNIFIED RATIO
                type: 'image',
                // NEW: Added gallery with placeholder images
                gallery: [
                    'https://github.com/umarwt06/umarwt06.github.io/blob/main/perfume.png?raw=true',
                    'https://placehold.co/800x1000/1e293b/e2e8f0?text=Perfume+Detail+Shot',
                    'https://placehold.co/800x1000/1e293b/e2e8f0?text=Perfume+Wireframe'
                ]
            },
            {
                title: '3D Model Of A Bench',
                category: '3D Model',
                software: 'Blender, Photoshop',
                description: 'An atmospheric, real-time environment scene built in Unreal Engine 5. The project focuses on modular asset creation, advanced material blending using trim sheets, and dynamic lighting with Lumen to create an immersive and technically optimized sci-fi corridor.',
                technicalDetails: 'Pipeline: Modular kit created in Blender, textured in Substance. Engine: UE5 with Lumen GI and Nanite. Assets: 4k trim sheets for environmental props, vertex painting for material blending.',
                image: 'https://i.postimg.cc/pm5Zhtdw/Render2.png',
                ratio: '4/5', // UNIFIED RATIO
                type: 'image',
                videoUrl: '',
                // NEW: Added gallery with placeholder images
                gallery: [
                    'https://i.postimg.cc/Hr82cCx1/Render.png',
                    'https://i.postimg.cc/pm5Zhtdw/Render2.png',
                    'https://i.postimg.cc/0zKfMqQg/Render3.png'
                    'https://i.postimg.cc/cvtmgNHy/Render4.png'
                    'https://i.postimg.cc/LJgTYMX2/Render5.png'
                    'https://i.postimg.cc/xXNRJSdx/Render6.png'
                ]
            },
            
            // --- Creative Code Projects ---
            {
                title: 'Python Asset Renamer Tool',
                category: 'Creative Code / Python',
                software: 'Python 3, Tkinter (GUI)',
                description: 'A custom desktop tool built with Python and Tkinter to automate batch renaming and folder structuring for large 3D asset exports. This script standardizes naming conventions, reducing pipeline errors and saving significant manual labor.',
                technicalDetails: 'Key Features: Regex-based parsing for file names, recursive folder traversal, multi-threading for performance, and a simple GUI for non-technical artists. Processes 1000+ files in under 2 seconds.',
                image: 'https://placehold.co/400x500/60a5fa/0f172a?text=Python+Tool+(4:5)',
                ratio: '4/5', // UNIFIED RATIO
                type: 'video',
                videoUrl: ''
            },
            
            // --- Web / E-commerce Projects ---
            {
                title: 'Webflow E-commerce CRO',
                category: 'Web / E-commerce',
                software: 'Webflow, Custom CSS/JS, Figma',
                description: 'Complete redesign and optimization of a direct-to-consumer e-commerce store. The project focused on Conversion Rate Optimization (CRO) for mobile devices and improving page speed, resulting in a 20% increase in mobile conversion.',
                technicalDetails: 'Impact: 20% increase in mobile conversion, Lighthouse score 92+. Stack: Webflow CMS for products, custom JavaScript for cart interactions, and Figma for initial UI/UX wireframing.',
                image: 'https://placehold.co/400x500/fcd34d/0f172a?text=Webflow+E-commerce+(4:5)',
                ratio: '4/5', // UNIFIED RATIO
                type: 'image',
                gallery: [
                    'https://placehold.co/800x1000/fcd34d/0f172a?text=Webflow+Homepage',
                    'https://placehold.co/800x1000/1e293b/e2e8f0?text=Webflow+Mobile+View'
                ]
            },
            {
                title: 'Full-Stack Landing Page',
                category: '3D Product Design',
                software: 'Blender, Photoshop',
                description: 'A sleek, modern 3D render of a portable power bank, designed for product marketing and e-commerce. The visualization highlights a minimalist aesthetic with a brushed aluminum finish and a high-contrast digital display, emphasizing both style and smart functionality for a premium tech accessory.',
                technicalDetails: 'Modeled and rendered in Blender (Cycles). The design features clean, hard-surface modeling with precise booleans for the digital display cutout. Materials are procedural, utilizing noise textures to achieve a realistic brushed metal effect. The scene is lit with a soft-box and area lights to create gentle reflections, and the digital display uses an emissive shader for a realistic glow.',
                image: 'https://i.postimg.cc/qvxY0Bs1/correct.png',
                ratio: '4/5', // UNIFIED RATIO
                type: 'image'
            },
        ];

        /**
         * Renders the portfolio items from the data array into the grid.
         */
        function renderPortfolio() {
            const grid = document.getElementById('portfolio-grid');
            if (!grid) return;

            grid.innerHTML = ''; 

            portfolioData.forEach((item, index) => {
                let aspectRatioClasses = ''; 
                
                // This logic block now correctly defaults to 4:5 if ratio is '4/5'
                if (item.ratio === '4/5') {
                    aspectRatioClasses = 'aspect-4x5'; 
                } 
                else if (item.ratio === '16/9') aspectRatioClasses = 'aspect-w-16 aspect-h-9'; 
                else if (item.ratio === '1/1') aspectRatioClasses = 'aspect-w-1 aspect-h-1'; 
                else if (item.ratio === '9/16') aspectRatioClasses = 'aspect-9x16'; 
                else {
                    aspectRatioClasses = 'aspect-4x5'; // Default fallback
                }
                
                const overlayText = item.type === 'video' ? 'VIEW ANIMATION' : 'VIEW BREAKDOWN';

                const itemHtml = `
                    <div class="project-card group relative glass-panel transition transform duration-300 cursor-pointer fade-in" 
                         style="--delay: ${index * 0.1}s;" data-index="${index}">
                        
                        <!-- This 'relative' container sets the 4:5 shape using padding -->
                        <div class="relative w-full ${aspectRatioClasses}"> 
                            
                            <!-- This 'img' is now 'absolute' to fill that 4:5 shape -->
                            <img src="${item.image}" alt="${item.title}" 
                                 class="absolute inset-0 w-full h-full object-cover transition-opacity duration-500 group-hover:opacity-60 prevent-download"
                                 onerror="this.onerror=null; this.src='https://placehold.co/400x500/1e293b/e2e8f0?text=Image+Not+Found';">
                            
                            <!-- This overlay is also 'absolute' to fill that 4:5 shape -->
                            <div class="absolute inset-0 bg-dark-panel/90 flex flex-col items-center justify-end p-4 text-center text-white/90 opacity-0 transition duration-500 group-hover:opacity-100">
                                <p class="text-xl font-extrabold">${item.title}</p>
                                <p class="text-sm font-semibold mt-1 text-primary-accent">${item.category}</p>
                                <span class="mt-3 text-xs font-bold px-3 py-1 bg-primary-accent text-dark-bg rounded-full shadow-lg">${overlayText}</span>
                            </div>
                        </div>
                    </div>
                `;
                grid.innerHTML += itemHtml;
            });
            
            document.querySelectorAll('.project-card[data-index]').forEach(card => {
                card.addEventListener('click', () => openModal(card.getAttribute('data-index'))); 
            });

            setupIntersectionObserver();
        }


        /**
         * Opens the modal with project details.
         */
        function openModal(indexString) {
            const index = parseInt(indexString, 10);
            if (isNaN(index) || index < 0 || index >= portfolioData.length) {
                console.error("Invalid index for openModal:", indexString);
                return; // Exit if index is invalid
            }
            const item = portfolioData[index];
            if (!item) return;

            const contentArea = document.getElementById('modal-content-area');
            contentArea.innerHTML = ''; 

            // Check if it's an IMAGE project
            if (item.type === 'image') {
                // Check if it has a gallery with multiple images
                if (item.gallery && item.gallery.length > 1) {
                    // Build Slider HTML
                    let slidesHtml = item.gallery.map((imgUrl, index) => {
                        return `
                            <div class="slider-slide ${index === 0 ? 'active' : ''}">
                                <img src="${imgUrl}" alt="${item.title} - Image ${index + 1}" class="prevent-download" 
                                     onerror="this.onerror=null; this.src='https://placehold.co/400x500/1e293b/e2e8f0?text=Image+Not+Found';">
                            </div>
                        `;
                    }).join('');

                    contentArea.innerHTML = `
                        <div class="slider-container">
                            ${slidesHtml}
                            <button class="slider-btn slider-btn-prev">&larr;</button>
                            <button class="slider-btn slider-btn-next">&rarr;</button>
                        </div>
                    `;

                    // Initialize Slider Logic
                    const slides = contentArea.querySelectorAll('.slider-slide');
                    const nextBtn = contentArea.querySelector('.slider-btn-next');
                    const prevBtn = contentArea.querySelector('.slider-btn-prev');
                    let currentSlide = 0;

                    function showSlide(index) {
                        slides.forEach((slide, i) => {
                            slide.classList.toggle('active', i === index);
                        });
                    }

                    nextBtn.addEventListener('click', () => {
                        currentSlide = (currentSlide + 1) % slides.length;
                        showSlide(currentSlide);
                    });

                    prevBtn.addEventListener('click', () => {
                        currentSlide = (currentSlide - 1 + slides.length) % slides.length;
                        showSlide(currentSlide);
                    });

                } else {
                    // Fallback to single image
                    contentArea.innerHTML = `<img src="${item.image}" alt="${item.title} Render" class="w-full h-auto object-contain rounded-lg prevent-download" style="max-height: 75vh;" onerror="this.onerror=null; this.src='https://placehold.co/400x500/1e293b/e2e8f0?text=Image+Not+Found';">`;
                }
            } 
            // Check if it's a VIDEO project
            else if (item.type === 'video' && item.videoUrl) {
                
                let embedHtml = '';
                
                // Check for any YouTube link and extract the ID
                const ytMatch = item.videoUrl.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/);

                if (ytMatch && ytMatch[1]) {
                    const videoId = ytMatch[1];
                    const embedUrl = `https://www.youtube.com/embed/${videoId}?rel=0&autoplay=1&controls=1&modestbranding=1&loop=1&playlist=${videoId}`;
                    
                    const [ratioW, ratioH] = item.ratio.split('/').map(Number);
                    let paddingPercentage = (ratioH / ratioW) * 100;
                    if (isNaN(paddingPercentage)) paddingPercentage = 56.25; // Default to 16:9 if ratio is bad
                    
                    embedHtml = `
                        <div class="relative w-full overflow-hidden" style="padding-top: ${paddingPercentage}%;"> 
                            <iframe src="${embedUrl}" 
                                frameborder="0" 
                                allow="autoplay; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen 
                                class="absolute top-0 left-0 w-full h-full"
                                referrerpolicy="no-referrer"></iframe>
                        </div>`;
                } 
                // Handle direct video links (Fiverr, etc.) with custom player
                else {
                    embedHtml = `
                        <div class="custom-player" id="player-container">
                            <video class="w-full h-auto" loop muted playsinline preload="metadata">
                                <source src="${item.videoUrl}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                            <div class="video-controls">
                                <button id="playPauseBtn" class="p-2">
                                    <svg id="playIcon" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8.118v3.764a1 1 0 001.555.832l3.197-1.882a1 1 0 000-1.664l-3.197-1.882z" clip-rule="evenodd" /></svg>
                                    <svg id="pauseIcon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h1a1 1 0 001-1V8a1 1 0 00-1-1H8zm3 0a1 1 0 00-1 1v4a1 1 0 001 1h1a1 1 0 001-1V8a1 1 0 00-1-1h-1z" clip-rule="evenodd" /></svg>
                                </button>
                                <span id="currentTime" class="video-time">00:00</span>
                                <div class="seek-bar-container">
                                    <div class="seek-bar-progress"></div>
                                </div>
                                <span id="durationTime" class="video-time">00:00</span>
                                <div class="volume-controls">
                                    <button id="muteBtn" class="p-2">
                                        <svg id="unmuteIcon" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM12.293 7.293a1 1 0 011.414 0L15 8.586l1.293-1.293a1 1 0 111.414 1.414L16.414 10l1.293 1.293a1 1 0 11-1.414 1.414L15 11.414l-1.293 1.293a1 1 0 01-1.414-1.414L13.586 10l-1.293-1.293a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                                        <svg id="muteIcon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 15.343a1 1 0 01-1.414 0L12 14.086l-1.243 1.257a1 1 0 01-1.414-1.414L10.586 12 9.343 10.757a1 1 0 011.414-1.414L12 10.586l1.243-1.257a1 1 0 011.414 1.414L13.414 12l1.243 1.257a1 1 0 010 1.414z" clip-rule="evenodd" /></svg>
                                    </button>
                                    <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.1" value="0"> <!-- Muted by default -->
                                </div>
                                <!-- FIX: Removed fullscreen button -->
                            </div>
                        </div>`;
                }
                
                contentArea.innerHTML = embedHtml;
                
                // If the custom player was added, initialize its controls
                if (embedHtml.includes('id="player-container"')) {
                    initializeCustomPlayer('player-container');
                }
            }

            document.getElementById('modal-title').textContent = item.title;
            document.getElementById('modal-category').textContent = item.category;
            document.getElementById('modal-software').textContent = item.software;
            document.getElementById('modal-description').textContent = item.description;
            document.getElementById('modal-technical').textContent = item.technicalDetails;

            const modal = document.getElementById('project-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            document.body.style.overflow = 'hidden'; 
        }

        /**
         * Closes the modal.
         */
        function closeModal(event) {
            if (!event || event.currentTarget === event.target) {
                const modal = document.getElementById('project-modal');
                modal.classList.add('hidden');
                modal.classList.remove('flex');
                document.body.style.overflow = ''; 

                const contentArea = document.getElementById('modal-content-area');
                contentArea.innerHTML = ''; 
            }
        }

        /**
         * Sets up the Intersection Observer for fade-in animations.
         */
        function setupIntersectionObserver() {
            const faders = document.querySelectorAll('.fade-in');
            const appearOptions = {
                threshold: 0.2, // Trigger when 20% of the item is visible
                rootMargin: "0px 0px -50px 0px" // Start 50px before it hits the bottom
            };

            const appearOnScroll = new IntersectionObserver(function(entries, appearOnScroll) {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) {
                        return;
                    } else {
                        entry.target.classList.add('is-visible');
                        appearOnScroll.unobserve(entry.target); // Stop observing once visible
                    }
                });
            }, appearOptions);

            faders.forEach(fader => {
                appearOnScroll.observe(fader);
            });
        }

        /**
         * Initializes the page on load.
         */
        window.onload = function() {
            renderPortfolio();
            document.getElementById('current-year').textContent = new Date().getFullYear();
            setupIntersectionObserver(); 
            document.getElementById('hero').classList.add('is-visible'); // Ensure hero animates on load
        };
    </script>
</body>
</html>

